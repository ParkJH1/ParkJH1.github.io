(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{23795:function(t,e,n){"use strict";n.d(e,{Z:function(){return A}});var r=n(63366),i=n(87462),s=n(67294),o=n(90512),u=n(94780),a=n(98216),f=n(90948),h=n(71657),l=n(18791),p=n(51705),c=n(15861),m=n(1588),g=n(34867);function getLinkUtilityClass(t){return(0,g.Z)("MuiLink",t)}let d=(0,m.Z)("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]);var b=n(54844),y=n(41796);let v={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},transformDeprecatedColors=t=>v[t]||t;var Link_getTextDecoration=({theme:t,ownerState:e})=>{let n=transformDeprecatedColors(e.color),r=(0,b.DW)(t,`palette.${n}`,!1)||e.color,i=(0,b.DW)(t,`palette.${n}Channel`);return"vars"in t&&i?`rgba(${i} / 0.4)`:(0,y.Fq)(r,.4)},_=n(85893);let B=["className","color","component","onBlur","onFocus","TypographyClasses","underline","variant","sx"],useUtilityClasses=t=>{let{classes:e,component:n,focusVisible:r,underline:i}=t,s={root:["root",`underline${(0,a.Z)(i)}`,"button"===n&&"button",r&&"focusVisible"]};return(0,u.Z)(s,getLinkUtilityClass,e)},F=(0,f.ZP)(c.Z,{name:"MuiLink",slot:"Root",overridesResolver:(t,e)=>{let{ownerState:n}=t;return[e.root,e[`underline${(0,a.Z)(n.underline)}`],"button"===n.component&&e.button]}})(({theme:t,ownerState:e})=>(0,i.Z)({},"none"===e.underline&&{textDecoration:"none"},"hover"===e.underline&&{textDecoration:"none","&:hover":{textDecoration:"underline"}},"always"===e.underline&&(0,i.Z)({textDecoration:"underline"},"inherit"!==e.color&&{textDecorationColor:Link_getTextDecoration({theme:t,ownerState:e})},{"&:hover":{textDecorationColor:"inherit"}}),"button"===e.component&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${d.focusVisible}`]:{outline:"auto"}})),L=s.forwardRef(function(t,e){let n=(0,h.Z)({props:t,name:"MuiLink"}),{className:u,color:a="primary",component:f="a",onBlur:c,onFocus:m,TypographyClasses:g,underline:d="always",variant:b="inherit",sx:y}=n,L=(0,r.Z)(n,B),{isFocusVisibleRef:A,onBlur:O,onFocus:w,ref:x}=(0,l.Z)(),[E,I]=s.useState(!1),T=(0,p.Z)(e,x),S=(0,i.Z)({},n,{color:a,component:f,focusVisible:E,underline:d,variant:b}),C=useUtilityClasses(S);return(0,_.jsx)(F,(0,i.Z)({color:a,className:(0,o.Z)(C.root,u),classes:g,component:f,onBlur:t=>{O(t),!1===A.current&&I(!1),c&&c(t)},onFocus:t=>{w(t),!0===A.current&&I(!0),m&&m(t)},ref:T,ownerState:S,variant:b,sx:[...Object.keys(v).includes(a)?[]:[{color:a}],...Array.isArray(y)?y:[y]]},L))});var A=L},35717:function(t){"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var TempCtor=function(){};TempCtor.prototype=e.prototype,t.prototype=new TempCtor,t.prototype.constructor=t}}},59519:function(t,e,n){"use strict";n.d(e,{oL:function(){return babyjub_buildBabyJub}});var r={};n.r(r),n.d(r,{abs:function(){return abs},add:function(){return add},band:function(){return band},bitLength:function(){return bitLength},bits:function(){return bits},bor:function(){return bor},bxor:function(){return bxor},div:function(){return div},e:function(){return o},eq:function(){return eq},exp:function(){return exp},fromArray:function(){return fromArray},fromRprBE:function(){return fromRprBE},fromRprLE:function(){return fromRprLE},fromString:function(){return fromString},geq:function(){return geq},gt:function(){return gt},isNegative:function(){return isNegative},isOdd:function(){return isOdd},isZero:function(){return isZero},land:function(){return land},leq:function(){return leq},lnot:function(){return lnot},lor:function(){return lor},lt:function(){return lt},mod:function(){return mod},mul:function(){return mul},naf:function(){return naf},neg:function(){return neg},neq:function(){return neq},one:function(){return h},pow:function(){return pow},shiftLeft:function(){return shiftLeft},shiftRight:function(){return shiftRight},shl:function(){return u},shr:function(){return a},square:function(){return square},sub:function(){return sub},toArray:function(){return toArray},toLEBuff:function(){return toLEBuff},toNumber:function(){return toNumber},toRprBE:function(){return toRprBE},toRprLE:function(){return toRprLE},toString:function(){return scalar_toString},zero:function(){return f}});var i={};n.r(i),n.d(i,{array2buffer:function(){return array2buffer},beBuff2int:function(){return beBuff2int},beInt2Buff:function(){return beInt2Buff},bitReverse:function(){return bitReverse},buffReverseBits:function(){return buffReverseBits},buffer2array:function(){return buffer2array},leBuff2int:function(){return leBuff2int},leInt2Buff:function(){return leInt2Buff},log2:function(){return utils_log2},stringifyBigInts:function(){return function stringifyBigInts(t){if("bigint"==typeof t||void 0!==t.eq)return t.toString(10);if(t instanceof Uint8Array)return fromRprLE(t,0);if(Array.isArray(t))return t.map(stringifyBigInts);{if("object"!=typeof t)return t;let e={},n=Object.keys(t);return n.forEach(n=>{e[n]=stringifyBigInts(t[n])}),e}}},stringifyFElements:function(){return function stringifyFElements(t,e){if("bigint"==typeof e||void 0!==e.eq)return e.toString(10);if(e instanceof Uint8Array)return t.toString(t.e(e));if(Array.isArray(e))return e.map(stringifyFElements.bind(this,t));{if("object"!=typeof e)return e;let n={},r=Object.keys(e);return r.forEach(r=>{n[r]=stringifyFElements(t,e[r])}),n}}},unstringifyBigInts:function(){return function unstringifyBigInts(t){if("string"==typeof t&&/^[0-9]+$/.test(t)||"string"==typeof t&&/^0x[0-9a-fA-F]+$/.test(t))return BigInt(t);if(Array.isArray(t))return t.map(unstringifyBigInts);{if("object"!=typeof t)return t;if(null===t)return null;let e={},n=Object.keys(t);return n.forEach(n=>{e[n]=unstringifyBigInts(t[n])}),e}}},unstringifyFElements:function(){return function unstringifyFElements(t,e){if("string"==typeof e&&/^[0-9]+$/.test(e)||"string"==typeof e&&/^0x[0-9a-fA-F]+$/.test(e))return t.e(e);if(Array.isArray(e))return e.map(unstringifyFElements.bind(this,t));{if("object"!=typeof e)return e;if(null===e)return null;let n={},r=Object.keys(e);return r.forEach(r=>{n[r]=unstringifyFElements(t,e[r])}),n}}}});let s=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];function fromString(t,e){return e&&10!=e?16==e?"0x"==t.slice(0,2)?BigInt(t):BigInt("0x"+t):void 0:BigInt(t)}let o=fromString;function fromArray(t,e){let n=BigInt(0);e=BigInt(e);for(let r=0;r<t.length;r++)n=n*e+BigInt(t[r]);return n}function bitLength(t){let e=t.toString(16);return(e.length-1)*4+s[parseInt(e[0],16)]}function isNegative(t){return BigInt(t)<BigInt(0)}function isZero(t){return!t}function shiftLeft(t,e){return BigInt(t)<<BigInt(e)}function shiftRight(t,e){return BigInt(t)>>BigInt(e)}let u=shiftLeft,a=shiftRight;function isOdd(t){return(BigInt(t)&BigInt(1))==BigInt(1)}function naf(t){let e=BigInt(t),n=[];for(;e;){if(e&BigInt(1)){let t=2-Number(e%BigInt(4));n.push(t),e-=BigInt(t)}else n.push(0);e>>=BigInt(1)}return n}function bits(t){let e=BigInt(t),n=[];for(;e;)e&BigInt(1)?n.push(1):n.push(0),e>>=BigInt(1);return n}function toNumber(t){if(t>BigInt(Number.MAX_SAFE_INTEGER))throw Error("Number too big");return Number(t)}function toArray(t,e){let n=[],r=BigInt(t);for(e=BigInt(e);r;)n.unshift(Number(r%e)),r/=e;return n}function add(t,e){return BigInt(t)+BigInt(e)}function sub(t,e){return BigInt(t)-BigInt(e)}function neg(t){return-BigInt(t)}function mul(t,e){return BigInt(t)*BigInt(e)}function square(t){return BigInt(t)*BigInt(t)}function pow(t,e){return BigInt(t)**BigInt(e)}function exp(t,e){return BigInt(t)**BigInt(e)}function abs(t){return BigInt(t)>=0?BigInt(t):-BigInt(t)}function div(t,e){return BigInt(t)/BigInt(e)}function mod(t,e){return BigInt(t)%BigInt(e)}function eq(t,e){return BigInt(t)==BigInt(e)}function neq(t,e){return BigInt(t)!=BigInt(e)}function lt(t,e){return BigInt(t)<BigInt(e)}function gt(t,e){return BigInt(t)>BigInt(e)}function leq(t,e){return BigInt(t)<=BigInt(e)}function geq(t,e){return BigInt(t)>=BigInt(e)}function band(t,e){return BigInt(t)&BigInt(e)}function bor(t,e){return BigInt(t)|BigInt(e)}function bxor(t,e){return BigInt(t)^BigInt(e)}function land(t,e){return BigInt(t)&&BigInt(e)}function lor(t,e){return BigInt(t)||BigInt(e)}function lnot(t){return!BigInt(t)}function toRprLE(t,e,n,r){let i="0000000"+n.toString(16),s=new Uint32Array(t.buffer,t.byteOffset+e,r/4),o=((i.length-7)*4-1>>5)+1;for(let t=0;t<o;t++)s[t]=parseInt(i.substring(i.length-8*t-8,i.length-8*t),16);for(let t=o;t<s.length;t++)s[t]=0;for(let e=4*s.length;e<r;e++)t[e]=toNumber(band(shiftRight(n,8*e),255))}function toRprBE(t,e,n,r){let i="0000000"+n.toString(16),s=new DataView(t.buffer,t.byteOffset+e,r),o=((i.length-7)*4-1>>5)+1;for(let t=0;t<o;t++)s.setUint32(r-4*t-4,parseInt(i.substring(i.length-8*t-8,i.length-8*t),16),!1);for(let t=0;t<r/4-o;t++)s[t]=0}function fromRprLE(t,e,n){n=n||t.byteLength,e=e||0;let r=new Uint32Array(t.buffer,t.byteOffset+e,n/4),i=Array(n/4);return r.forEach((t,e)=>i[i.length-e-1]=t.toString(16).padStart(8,"0")),fromString(i.join(""),16)}function fromRprBE(t,e,n){n=n||t.byteLength,e=e||0;let r=new DataView(t.buffer,t.byteOffset+e,n),i=Array(n/4);for(let t=0;t<n/4;t++)i[t]=r.getUint32(4*t,!1).toString(16).padStart(8,"0");return fromString(i.join(""),16)}function scalar_toString(t,e){return t.toString(e)}function toLEBuff(t){let e=new Uint8Array(Math.floor((bitLength(t)-1)/8)+1);return toRprLE(e,0,t,e.byteLength),e}let f=o(0),h=o(1),l=[];for(let t=0;t<256;t++)l[t]=function(t,e){let n=0,r=t;for(let t=0;t<8;t++)n<<=1,n|=1&r,r>>=1;return n}(t,0);function quarterRound(t,e,n,r,i){t[e]=t[e]+t[n]>>>0,t[i]=(t[i]^t[e])>>>0,t[i]=(t[i]<<16|t[i]>>>16&65535)>>>0,t[r]=t[r]+t[i]>>>0,t[n]=(t[n]^t[r])>>>0,t[n]=(t[n]<<12|t[n]>>>20&4095)>>>0,t[e]=t[e]+t[n]>>>0,t[i]=(t[i]^t[e])>>>0,t[i]=(t[i]<<8|t[i]>>>24&255)>>>0,t[r]=t[r]+t[i]>>>0,t[n]=(t[n]^t[r])>>>0,t[n]=(t[n]<<7|t[n]>>>25&127)>>>0}let ChaCha=class ChaCha{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=Array(16)}nextU32(){return 16==this.idx&&this.update(),this.buff[this.idx++]}nextU64(){return add(mul(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(1&this.nextU32())==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let e=0;e<10;e++){var t;quarterRound(t=this.buff,0,4,8,12),quarterRound(t,1,5,9,13),quarterRound(t,2,6,10,14),quarterRound(t,3,7,11,15),quarterRound(t,0,5,10,15),quarterRound(t,1,6,11,12),quarterRound(t,2,7,8,13),quarterRound(t,3,4,9,14)}for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,0==this.state[12]&&(this.state[13]=this.state[13]+1>>>0,0==this.state[13]&&(this.state[14]=this.state[14]+1>>>0,0==this.state[14]&&(this.state[15]=this.state[15]+1>>>0)))}};n(42474);let p=null;function getThreadRng(){return p||(p=new ChaCha(function(){let t=function(t){let e=new Uint8Array(t);if(void 0!==globalThis.crypto)globalThis.crypto.getRandomValues(e);else for(let n=0;n<t;n++)e[n]=4294967296*Math.random()>>>0;return e}(32),e=new Uint32Array(t.buffer),n=[];for(let t=0;t<8;t++)n.push(e[t]);return n}()))}var c=n(47571);function beBuff2int(t){let e=BigInt(0),n=t.length,r=0,i=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n>0;)n>=4?(n-=4,e+=BigInt(i.getUint32(n))<<BigInt(8*r),r+=4):n>=2?(n-=2,e+=BigInt(i.getUint16(n))<<BigInt(8*r),r+=2):(n-=1,e+=BigInt(i.getUint8(n))<<BigInt(8*r),r+=1);return e}function beInt2Buff(t,e){let n=t,r=new Uint8Array(e),i=new DataView(r.buffer),s=e;for(;s>0;)s-4>=0?(s-=4,i.setUint32(s,Number(n&BigInt(4294967295))),n>>=BigInt(32)):s-2>=0?(s-=2,i.setUint16(s,Number(n&BigInt(65535))),n>>=BigInt(16)):(s-=1,i.setUint8(s,Number(n&BigInt(255))),n>>=BigInt(8));if(n)throw Error("Number does not fit in this length");return r}function leBuff2int(t){let e=BigInt(0),n=0,r=new DataView(t.buffer,t.byteOffset,t.byteLength);for(;n<t.length;)n+4<=t.length?(e+=BigInt(r.getUint32(n,!0))<<BigInt(8*n),n+=4):n+2<=t.length?(e+=BigInt(r.getUint16(n,!0))<<BigInt(8*n),n+=2):(e+=BigInt(r.getUint8(n,!0))<<BigInt(8*n),n+=1);return e}function leInt2Buff(t,e){let n=t;void 0===e&&0==(e=Math.floor((bitLength(t)-1)/8)+1)&&(e=1);let r=new Uint8Array(e),i=new DataView(r.buffer),s=0;for(;s<e;)s+4<=e?(i.setUint32(s,Number(n&BigInt(4294967295)),!0),s+=4,n>>=BigInt(32)):s+2<=e?(i.setUint16(s,Number(n&BigInt(65535)),!0),s+=2,n>>=BigInt(16)):(i.setUint8(s,Number(n&BigInt(255)),!0),s+=1,n>>=BigInt(8));if(n)throw Error("Number does not fit in this length");return r}let m=[];for(let t=0;t<256;t++)m[t]=function(t,e){let n=0,r=t;for(let t=0;t<8;t++)n<<=1,n|=1&r,r>>=1;return n}(t,0);function bitReverse(t,e){return(m[t>>>24]|m[t>>>16&255]<<8|m[t>>>8&255]<<16|m[255&t]<<24)>>>32-e}function utils_log2(t){return((4294901760&t)!=0?(t&=4294901760,16):0)|((4278255360&t)!=0?(t&=4278255360,8):0)|((4042322160&t)!=0?(t&=4042322160,4):0)|((3435973836&t)!=0?(t&=3435973836,2):0)|(2863311530&t)!=0}function buffReverseBits(t,e){let n=t.byteLength/e,r=utils_log2(n);if(n!=1<<r)throw Error("Invalid number of pointers");for(let i=0;i<n;i++){let n=bitReverse(i,r);if(i>n){let r=t.slice(i*e,(i+1)*e);t.set(t.slice(n*e,(n+1)*e),i*e),t.set(r,n*e)}}}function array2buffer(t,e){let n=new Uint8Array(e*t.length);for(let r=0;r<t.length;r++)n.set(t[r],r*e);return n}function buffer2array(t,e){let n=t.byteLength/e,r=Array(n);for(let i=0;i<n;i++)r[i]=t.slice(i*e,i*e+e);return r}let BigBuffer=class BigBuffer{constructor(t){this.buffers=[],this.byteLength=t;for(let e=0;e<t;e+=1073741824){let n=Math.min(t-e,1073741824);this.buffers.push(new Uint8Array(n))}}slice(t,e){let n;void 0===e&&(e=this.byteLength),void 0===t&&(t=0);let r=e-t,i=Math.floor(t/1073741824),s=Math.floor((t+r-1)/1073741824);if(i==s||0==r)return this.buffers[i].slice(t%1073741824,t%1073741824+r);let o=i,u=t%1073741824,a=r;for(;a>0;){let t=u+a>1073741824?1073741824-u:a,e=new Uint8Array(this.buffers[o].buffer,this.buffers[o].byteOffset+u,t);if(t==r)return e.slice();n||(n=r<=1073741824?new Uint8Array(r):new BigBuffer(r)),n.set(e,r-a),a-=t,o++,u=0}return n}set(t,e){void 0===e&&(e=0);let n=t.byteLength;if(0==n)return;let r=Math.floor(e/1073741824),i=Math.floor((e+n-1)/1073741824);if(r==i)return t instanceof BigBuffer&&1==t.buffers.length?this.buffers[r].set(t.buffers[0],e%1073741824):this.buffers[r].set(t,e%1073741824);let s=r,o=e%1073741824,u=n;for(;u>0;){let e=o+u>1073741824?1073741824-o:u,r=t.slice(n-u,n-u+e),i=new Uint8Array(this.buffers[s].buffer,this.buffers[s].byteOffset+o,e);i.set(r),u-=e,s++,o=0}}};function buildBatchConvert(t,e,n,r){return async function(i){let s;let o=Math.floor(i.byteLength/n);if(o*n!==i.byteLength)throw Error("Invalid buffer size");let u=Math.floor(o/t.concurrency),a=[];for(let s=0;s<t.concurrency;s++){let f;if(0==(f=s<t.concurrency-1?u:o-s*u))continue;let h=i.slice(s*u*n,s*u*n+f*n),l=[{cmd:"ALLOCSET",var:0,buff:h},{cmd:"ALLOC",var:1,len:r*f},{cmd:"CALL",fnName:e,params:[{var:0},{val:f},{var:1}]},{cmd:"GET",out:0,var:1,len:r*f}];a.push(t.queueAction(l))}let f=await Promise.all(a);s=i instanceof BigBuffer?new BigBuffer(o*r):new Uint8Array(o*r);let h=0;for(let t=0;t<f.length;t++)s.set(f[t][0],h),h+=f[t][0].byteLength;return s}}let WasmField1=class WasmField1{constructor(t,e,n,r){if(this.tm=t,this.prefix=e,this.p=r,this.n8=n,this.type="F1",this.m=1,this.half=shiftRight(r,h),this.bitLength=bitLength(r),this.mask=sub(shiftLeft(h,this.bitLength),h),this.pOp1=t.alloc(n),this.pOp2=t.alloc(n),this.pOp3=t.alloc(n),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(n/8),this.n32=Math.floor(n/4),8*this.n64!=this.n8)throw Error("n8 must be a multiple of 8");this.half=shiftRight(this.p,h),this.nqr=this.two;let i=this.exp(this.nqr,this.half);for(;!this.eq(i,this.negone);)this.nqr=this.add(this.nqr,this.one),i=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let s=sub(this.p,h);for(;!isOdd(s);)this.s=this.s+1,s=shiftRight(s,h);this.w=[],this.w[this.s]=this.exp(this.nqr,s);for(let t=this.s-1;t>=0;t--)this.w[t]=this.square(this.w[t+1]);if(!this.eq(this.w[0],this.one))throw Error("Error calculating roots of unity");this.batchToMontgomery=buildBatchConvert(t,e+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=buildBatchConvert(t,e+"_batchFromMontgomery",this.n8,this.n8)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=toLEBuff(o(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,e){if(t instanceof Uint8Array)return t;let n=o(t,e);isNegative(n)?(gt(n=neg(n),this.p)&&(n=mod(n,this.p)),n=sub(this.p,n)):gt(n,this.p)&&(n=mod(n,this.p));let r=leInt2Buff(n,this.n8);return this.toMontgomery(r)}toString(t,e){let n=this.fromMontgomery(t),r=fromRprLE(n,0);return scalar_toString(r,e)}fromRng(t){let e;let n=new Uint8Array(this.n8);do{e=f;for(let n=0;n<this.n64;n++)e=add(e,shiftLeft(t.nextU64(),64*n));e=band(e,this.mask)}while(geq(e,this.p));return toRprLE(n,0,e,this.n8),n}random(){return this.fromRng(getThreadRng())}toObject(t){let e=this.fromMontgomery(t);return fromRprLE(e,0)}fromObject(t){let e=new Uint8Array(this.n8);return toRprLE(e,0,t,this.n8),this.toMontgomery(e)}toRprLE(t,e,n){t.set(this.fromMontgomery(n),e)}toRprBE(t,e,n){let r=this.fromMontgomery(n);for(let t=0;t<this.n8/2;t++){let e=r[t];r[t]=r[this.n8-1-t],r[this.n8-1-t]=e}t.set(r,e)}fromRprLE(t,e){e=e||0;let n=t.slice(e,e+this.n8);return this.toMontgomery(n)}async batchInverse(t){let e,n=!1,r=this.n8,i=this.n8;Array.isArray(t)?(t=array2buffer(t,r),n=!0):t=t.slice(0,t.byteLength);let s=Math.floor(t.byteLength/r);if(s*r!==t.byteLength)throw Error("Invalid buffer size");let o=Math.floor(s/this.tm.concurrency),u=[];for(let e=0;e<this.tm.concurrency;e++){let n;if(0==(n=e<this.tm.concurrency-1?o:s-e*o))continue;let a=t.slice(e*o*r,e*o*r+n*r),f=[{cmd:"ALLOCSET",var:0,buff:a},{cmd:"ALLOC",var:1,len:i*n},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:r},{val:n},{var:1},{val:i}]},{cmd:"GET",out:0,var:1,len:i*n}];u.push(this.tm.queueAction(f))}let a=await Promise.all(u);e=t instanceof BigBuffer?new BigBuffer(s*i):new Uint8Array(s*i);let f=0;for(let t=0;t<a.length;t++)e.set(a[t][0],f),f+=a[t][0].byteLength;return n?buffer2array(e,i):e}};let WasmField2=class WasmField2{constructor(t,e,n){this.tm=t,this.prefix=e,this.F=n,this.type="F2",this.m=2*n.m,this.n8=2*this.F.n8,this.n32=2*this.F.n32,this.n64=2*this.F.n64,this.pOp1=t.alloc(2*n.n8),this.pOp2=t.alloc(2*n.n8),this.pOp3=t.alloc(2*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){return this.op2("_add",t,e)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}mul1(t,e){return this.op2("_mul1",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=toLEBuff(o(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&2==t.length){let n=this.F.e(t[0],e),r=this.F.e(t[1],e),i=new Uint8Array(2*this.F.n8);return i.set(n),i.set(r,2*this.F.n8),i}throw Error("invalid F2")}toString(t,e){let n=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8),e);return`[${n}, ${r}]`}fromRng(t){let e=this.F.fromRng(t),n=this.F.fromRng(t),r=new Uint8Array(2*this.F.n8);return r.set(e),r.set(n,this.F.n8),r}random(){return this.fromRng(getThreadRng())}toObject(t){let e=this.F.toObject(t.slice(0,this.F.n8)),n=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));return[e,n]}fromObject(t){let e=new Uint8Array(2*this.F.n8),n=this.F.fromObject(t[0]),r=this.F.fromObject(t[1]);return e.set(n),e.set(r,this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}};let WasmField3=class WasmField3{constructor(t,e,n){this.tm=t,this.prefix=e,this.F=n,this.type="F3",this.m=3*n.m,this.n8=3*this.F.n8,this.n32=3*this.F.n32,this.n64=3*this.F.n64,this.pOp1=t.alloc(3*n.n8),this.pOp2=t.alloc(3*n.n8),this.pOp3=t.alloc(3*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[e+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,e){return this.op2Bool("_eq",t,e)}isZero(t){return this.op1Bool("_isZero",t)}add(t,e){return this.op2("_add",t,e)}sub(t,e){return this.op2("_sub",t,e)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,e){return this.op2("_mul",t,e)}div(t,e){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,e){return e instanceof Uint8Array||(e=toLEBuff(o(e))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,e){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&3==t.length){let n=this.F.e(t[0],e),r=this.F.e(t[1],e),i=this.F.e(t[2],e),s=new Uint8Array(3*this.F.n8);return s.set(n),s.set(r,this.F.n8),s.set(i,2*this.F.n8),s}throw Error("invalid F3")}toString(t,e){let n=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),i=this.F.toString(t.slice(2*this.F.n8),e);return`[${n}, ${r}, ${i}]`}fromRng(t){let e=this.F.fromRng(t),n=this.F.fromRng(t),r=this.F.fromRng(t),i=new Uint8Array(3*this.F.n8);return i.set(e),i.set(n,this.F.n8),i.set(r,2*this.F.n8),i}random(){return this.fromRng(getThreadRng())}toObject(t){let e=this.F.toObject(t.slice(0,this.F.n8)),n=this.F.toObject(t.slice(this.F.n8,2*this.F.n8)),r=this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8));return[e,n,r]}fromObject(t){let e=new Uint8Array(3*this.F.n8),n=this.F.fromObject(t[0]),r=this.F.fromObject(t[1]),i=this.F.fromObject(t[2]);return e.set(n),e.set(r,this.F.n8),e.set(i,2*this.F.n8),e}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,2*this.F.n8)}c3(t){return t.slice(2*this.F.n8)}};let WasmCurve=class WasmCurve{constructor(t,e,n,r,i,s){this.tm=t,this.prefix=e,this.F=n,this.pOp1=t.alloc(3*n.n8),this.pOp2=t.alloc(3*n.n8),this.pOp3=t.alloc(3*n.n8),this.tm.instance.exports[e+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,3*n.n8),this.tm.instance.exports[e+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,2*n.n8),this.one=this.tm.getBuff(r,3*n.n8),this.g=this.one,this.oneAffine=this.tm.getBuff(r,2*n.n8),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(i,n.n8),s&&(this.cofactor=toLEBuff(s)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=buildBatchConvert(t,e+"_batchLEMtoC",2*n.n8,n.n8),this.batchLEMtoU=buildBatchConvert(t,e+"_batchLEMtoU",2*n.n8,2*n.n8),this.batchCtoLEM=buildBatchConvert(t,e+"_batchCtoLEM",n.n8,2*n.n8),this.batchUtoLEM=buildBatchConvert(t,e+"_batchUtoLEM",2*n.n8,2*n.n8),this.batchToJacobian=buildBatchConvert(t,e+"_batchToJacobian",2*n.n8,3*n.n8),this.batchToAffine=buildBatchConvert(t,e+"_batchToAffine",3*n.n8,2*n.n8)}op2(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op2bool(t,e,n){return this.tm.setBuff(this.pOp1,e),this.tm.setBuff(this.pOp2,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}op1Affine(t,e){return this.tm.setBuff(this.pOp1,e),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,2*this.F.n8)}op1Bool(t,e){return this.tm.setBuff(this.pOp1,e),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_add",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_addMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_addMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_addAffine",t,e)}throw Error("invalid point size")}sub(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_sub",t,e);if(e.byteLength==2*this.F.n8)return this.op2("_subMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2("_subMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2("_subAffine",t,e)}throw Error("invalid point size")}neg(t){if(t.byteLength==3*this.F.n8)return this.op1("_neg",t);if(t.byteLength==2*this.F.n8)return this.op1Affine("_negAffine",t);throw Error("invalid point size")}double(t){if(t.byteLength==3*this.F.n8)return this.op1("_double",t);if(t.byteLength==2*this.F.n8)return this.op1("_doubleAffine",t);throw Error("invalid point size")}isZero(t){if(t.byteLength==3*this.F.n8)return this.op1Bool("_isZero",t);if(t.byteLength==2*this.F.n8)return this.op1Bool("_isZeroAffine",t);throw Error("invalid point size")}timesScalar(t,e){let n;if(e instanceof Uint8Array||(e=toLEBuff(o(e))),t.byteLength==3*this.F.n8)n=this.prefix+"_timesScalar";else if(t.byteLength==2*this.F.n8)n=this.prefix+"_timesScalarAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[n](this.pOp1,this.pOp2,e.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}timesFr(t,e){let n;if(t.byteLength==3*this.F.n8)n=this.prefix+"_timesFr";else if(t.byteLength==2*this.F.n8)n=this.prefix+"_timesFrAffine";else throw Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,e),this.tm.instance.exports[n](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,3*this.F.n8)}eq(t,e){if(t.byteLength==3*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eq",t,e);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqMixed",t,e);throw Error("invalid point size")}if(t.byteLength==2*this.F.n8){if(e.byteLength==3*this.F.n8)return this.op2bool("_eqMixed",e,t);if(e.byteLength==2*this.F.n8)return this.op2bool("_eqAffine",t,e)}throw Error("invalid point size")}toAffine(t){if(t.byteLength==3*this.F.n8)return this.op1Affine("_toAffine",t);if(t.byteLength==2*this.F.n8)return t;throw Error("invalid point size")}toJacobian(t){if(t.byteLength==3*this.F.n8)return t;if(t.byteLength==2*this.F.n8)return this.op1("_toJacobian",t);throw Error("invalid point size")}toRprUncompressed(t,e,n){if(this.tm.setBuff(this.pOp1,n),n.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(n.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let r=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(r,e)}fromRprUncompressed(t,e){let n=t.slice(e,e+2*this.F.n8);return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,2*this.F.n8)}toRprCompressed(t,e,n){if(this.tm.setBuff(this.pOp1,n),n.byteLength==3*this.F.n8)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(n.byteLength!=2*this.F.n8)throw Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let r=this.tm.getBuff(this.pOp1,this.F.n8);t.set(r,e)}fromRprCompressed(t,e){let n=t.slice(e,e+this.F.n8);return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,2*this.F.n8)}toUncompressed(t){let e=new Uint8Array(2*this.F.n8);return this.toRprUncompressed(e,0,t),e}toRprLEM(t,e,n){if(n.byteLength==2*this.F.n8){t.set(n,e);return}if(n.byteLength==3*this.F.n8){this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let r=this.tm.getBuff(this.pOp1,2*this.F.n8);t.set(r,e)}else throw Error("invalid point size")}fromRprLEM(t,e){return e=e||0,t.slice(e,e+2*this.F.n8)}toString(t,e){if(t.byteLength==3*this.F.n8){let n=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8,2*this.F.n8),e),i=this.F.toString(t.slice(2*this.F.n8),e);return`[ ${n}, ${r}, ${i} ]`}if(t.byteLength==2*this.F.n8){let n=this.F.toString(t.slice(0,this.F.n8),e),r=this.F.toString(t.slice(this.F.n8),e);return`[ ${n}, ${r} ]`}throw Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let e=this.F,n=this.toAffine(t),r=n.slice(0,this.F.n8),i=n.slice(this.F.n8,2*this.F.n8),s=e.add(e.mul(e.square(r),r),this.b),o=e.square(i);return e.eq(s,o)}fromRng(t){let e,n;let r=this.F,i=[];do i[0]=r.fromRng(t),e=t.nextBool(),n=r.add(r.mul(r.square(i[0]),i[0]),this.b);while(!r.isSquare(n));i[1]=r.sqrt(n);let s=r.isNegative(i[1]);e^s&&(i[1]=r.neg(i[1]));let o=new Uint8Array(2*this.F.n8);return o.set(i[0]),o.set(i[1],this.F.n8),this.cofactor&&(o=this.timesScalar(o,this.cofactor)),o}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let e=this.F.toObject(t.slice(0,this.F.n8)),n=this.F.toObject(t.slice(this.F.n8,2*this.F.n8));return[e,n,t.byteLength==3*this.F.n8?this.F.toObject(t.slice(2*this.F.n8,3*this.F.n8)):this.F.toObject(this.F.one)]}fromObject(t){let e;let n=this.F.fromObject(t[0]),r=this.F.fromObject(t[1]);if(e=3==t.length?this.F.fromObject(t[2]):this.F.one,this.F.isZero(e,this.F.one))return this.zeroAffine;if(this.F.eq(e,this.F.one)){let t=new Uint8Array(2*this.F.n8);return t.set(n),t.set(r,this.F.n8),t}{let t=new Uint8Array(3*this.F.n8);return t.set(n),t.set(r,this.F.n8),t.set(e,2*this.F.n8),t}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){let e=this.toAffine(t);return e.slice(0,this.F.n8)}y(t){let e=this.toAffine(t);return e.slice(this.F.n8)}};function thread(t){let e,n;async function init(t){let r=new Uint8Array(t.code),i=await WebAssembly.compile(r);n=new WebAssembly.Memory({initial:t.init,maximum:32767}),e=await WebAssembly.instantiate(i,{env:{memory:n}})}function alloc(t){let e=new Uint32Array(n.buffer,0,1);for(;3&e[0];)e[0]++;let r=e[0];if(e[0]+=t,e[0]+t>n.buffer.byteLength){let r=n.buffer.byteLength/65536,i=Math.floor((e[0]+t)/65536)+1;i>32767&&(i=32767),n.grow(i-r)}return r}function setBuffer(t,e){let r=new Uint8Array(n.buffer);r.set(new Uint8Array(e),t)}function runTask(t){if("INIT"==t[0].cmd)return init(t[0]);let r={vars:[],out:[]},i=new Uint32Array(n.buffer,0,1),s=i[0];for(let i=0;i<t.length;i++)switch(t[i].cmd){case"ALLOCSET":r.vars[t[i].var]=function(t){let e=alloc(t.byteLength);return setBuffer(e,t),e}(t[i].buff);break;case"ALLOC":r.vars[t[i].var]=alloc(t[i].len);break;case"SET":setBuffer(r.vars[t[i].var],t[i].buff);break;case"CALL":{let n=[];for(let e=0;e<t[i].params.length;e++){let s=t[i].params[e];void 0!==s.var?n.push(r.vars[s.var]+(s.offset||0)):void 0!==s.val&&n.push(s.val)}e.exports[t[i].fnName](...n);break}case"GET":r.out[t[i].out]=(function(t,e){let r=new Uint8Array(n.buffer);return new Uint8Array(r.buffer,r.byteOffset+t,e)})(r.vars[t[i].var],t[i].len).slice();break;default:throw Error("Invalid cmd")}let o=new Uint32Array(n.buffer,0,1);return o[0]=s,r.out}return t&&(t.onmessage=function(e){let n;if("INIT"==(n=e.data?e.data:e)[0].cmd)init(n[0]).then(function(){t.postMessage(n.result)});else if("TERMINATE"==n[0].cmd)t.close();else{let e=runTask(n);t.postMessage(e)}}),runTask}var g=n(73461),d=n(84763);let Deferred=class Deferred{constructor(){this.promise=new Promise((t,e)=>{this.reject=e,this.resolve=t})}};let b=globalThis.btoa("("+thread.toString()+")(self)"),y="data:application/javascript;base64,"+b;async function buildThreadManager(t,e){let n=new ThreadManager;n.memory=new WebAssembly.Memory({initial:25}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);let r=await WebAssembly.compile(t.code);if(n.instance=await WebAssembly.instantiate(r,{env:{memory:n.memory}}),n.singleThread=e,n.initalPFree=n.u32[0],n.pq=t.pq,n.pr=t.pr,n.pG1gen=t.pG1gen,n.pG1zero=t.pG1zero,n.pG2gen=t.pG2gen,n.pG2zero=t.pG2zero,n.pOneT=t.pOneT,e)n.code=t.code,n.taskManager=thread(),await n.taskManager([{cmd:"INIT",init:25,code:n.code.slice()}]),n.concurrency=1;else{let e;n.workers=[],n.pendingDeferreds=[],n.working=[],0==(e="object"==typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:g.cpus().length)&&(e=2),e>64&&(e=64),n.concurrency=e;for(let t=0;t<e;t++)n.workers[t]=new d(y),n.workers[t].addEventListener("message",function(t){return function(e){let r;r=e&&e.data?e.data:e,n.working[t]=!1,n.pendingDeferreds[t].resolve(r),n.processWorks()}}(t)),n.working[t]=!1;let r=[];for(let e=0;e<n.workers.length;e++){let i=t.code.slice();r.push(n.postAction(e,[{cmd:"INIT",init:25,code:i}],[i.buffer]))}await Promise.all(r)}return n}let ThreadManager=class ThreadManager{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(0!=this.oldPFree)throw Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(0==this.oldPFree)throw Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,e,n,r){if(this.working[t])throw Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=r||new Deferred,this.workers[t].postMessage(e,n),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(!1==this.working[t]){let e=this.actionQueue.shift();this.postAction(t,e.data,e.transfers,e.deferred)}}queueAction(t,e){let n=new Deferred;if(this.singleThread){let e=this.taskManager(t);n.resolve(e)}else this.actionQueue.push({data:t,transfers:e,deferred:n}),this.processWorks();return n.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let e=this.alloc(t.byteLength);return this.setBuff(e,t),e}getBuff(t,e){return this.u8.slice(t,t+e)}setBuff(t,e){this.u8.set(new Uint8Array(e),t)}alloc(t){for(;3&this.u32[0];)this.u32[0]++;let e=this.u32[0];return this.u32[0]+=t,e}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await new Promise(t=>setTimeout(t,200))}};function buildBatchApplyKey(t,e){let n=t[e],r=t.Fr,i=t.tm;t[e].batchApplyKey=async function(t,s,o,u,a){let f,h,l,p,c,m;if(u=u||"affine",a=a||"affine","G1"==e)"jacobian"==u?(l=3*n.F.n8,f="g1m_batchApplyKey"):(l=2*n.F.n8,f="g1m_batchApplyKeyMixed"),p=3*n.F.n8,"jacobian"==a?c=3*n.F.n8:(h="g1m_batchToAffine",c=2*n.F.n8);else if("G2"==e)"jacobian"==u?(l=3*n.F.n8,f="g2m_batchApplyKey"):(l=2*n.F.n8,f="g2m_batchApplyKeyMixed"),p=3*n.F.n8,"jacobian"==a?c=3*n.F.n8:(h="g2m_batchToAffine",c=2*n.F.n8);else if("Fr"==e)f="frm_batchApplyKey",l=n.n8,p=n.n8,c=n.n8;else throw Error("Invalid group: "+e);let g=Math.floor(t.byteLength/l),d=Math.floor(g/i.concurrency),b=[];o=r.e(o);let y=r.e(s);for(let e=0;e<i.concurrency;e++){let n;if(0==(n=e<i.concurrency-1?d:g-e*d))continue;let s=[];s.push({cmd:"ALLOCSET",var:0,buff:t.slice(e*d*l,e*d*l+n*l)}),s.push({cmd:"ALLOCSET",var:1,buff:y}),s.push({cmd:"ALLOCSET",var:2,buff:o}),s.push({cmd:"ALLOC",var:3,len:n*Math.max(p,c)}),s.push({cmd:"CALL",fnName:f,params:[{var:0},{val:n},{var:1},{var:2},{var:3}]}),h&&s.push({cmd:"CALL",fnName:h,params:[{var:3},{val:n},{var:3}]}),s.push({cmd:"GET",out:0,var:3,len:n*c}),b.push(i.queueAction(s)),y=r.mul(y,r.exp(o,n))}let v=await Promise.all(b);m=t instanceof BigBuffer?new BigBuffer(g*c):new Uint8Array(g*c);let _=0;for(let t=0;t<v.length;t++)m.set(v[t][0],_),_+=v[t][0].byteLength;return m}}let v=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];function buildMultiexp(t,e){let n=t[e],r=n.tm;async function _multiExpChunk(t,r,i,s,o){let u,a;if(!(t instanceof Uint8Array))throw s&&s.error(`${o} _multiExpChunk buffBases is not Uint8Array`),Error(`${o} _multiExpChunk buffBases is not Uint8Array`);if(!(r instanceof Uint8Array))throw s&&s.error(`${o} _multiExpChunk buffScalars is not Uint8Array`),Error(`${o} _multiExpChunk buffScalars is not Uint8Array`);if(i=i||"affine","G1"==e)"affine"==i?(a="g1m_multiexpAffine_chunk",u=2*n.F.n8):(a="g1m_multiexp_chunk",u=3*n.F.n8);else if("G2"==e)"affine"==i?(a="g2m_multiexpAffine_chunk",u=2*n.F.n8):(a="g2m_multiexp_chunk",u=3*n.F.n8);else throw Error("Invalid group");let f=Math.floor(t.byteLength/u);if(0==f)return n.zero;let h=Math.floor(r.byteLength/f);if(h*f!=r.byteLength)throw Error("Scalar size does not match");let l=v[utils_log2(f)],p=Math.floor((8*h-1)/l)+1,c=[];for(let e=0;e<p;e++){let i=[{cmd:"ALLOCSET",var:0,buff:t},{cmd:"ALLOCSET",var:1,buff:r},{cmd:"ALLOC",var:2,len:3*n.F.n8},{cmd:"CALL",fnName:a,params:[{var:0},{var:1},{val:h},{val:f},{val:e*l},{val:Math.min(8*h-e*l,l)},{var:2}]},{cmd:"GET",out:0,var:2,len:3*n.F.n8}];c.push(n.tm.queueAction(i))}let m=await Promise.all(c),g=n.zero;for(let t=m.length-1;t>=0;t--){if(!n.isZero(g))for(let t=0;t<l;t++)g=n.double(g);g=n.add(g,m[t][0])}return g}async function _multiExp(t,i,s,o,u){let a,f;if("G1"==e)a="affine"==s?2*n.F.n8:3*n.F.n8;else if("G2"==e)a="affine"==s?2*n.F.n8:3*n.F.n8;else throw Error("Invalid group");let h=Math.floor(t.byteLength/a),l=Math.floor(i.byteLength/h);if(l*h!=i.byteLength)throw Error("Scalar size does not match");let p=v[utils_log2(h)],c=Math.floor((8*l-1)/p)+1;(f=Math.floor(h/(r.concurrency/c)))>4194304&&(f=4194304),f<1024&&(f=1024);let m=[];for(let e=0;e<h;e+=f){o&&o.debug(`Multiexp start: ${u}: ${e}/${h}`);let n=Math.min(h-e,f),r=t.slice(e*a,(e+n)*a),p=i.slice(e*l,(e+n)*l);m.push(_multiExpChunk(r,p,s,o,u).then(t=>(o&&o.debug(`Multiexp end: ${u}: ${e}/${h}`),t)))}let g=await Promise.all(m),d=n.zero;for(let t=g.length-1;t>=0;t--)d=n.add(d,g[t]);return d}n.multiExp=async function(t,e,n,r){return await _multiExp(t,e,"jacobian",n,r)},n.multiExpAffine=async function(t,e,n,r){return await _multiExp(t,e,"affine",n,r)}}function buildFFT(t,e){let n=t[e],r=t.Fr,i=n.tm;async function _fft(t,s,o,u,a,f){let h,l,p,c,m,g,d,b,y,v,_;o=o||"affine",u=u||"affine","G1"==e?("affine"==o?(h=2*n.F.n8,c="g1m_batchToJacobian"):h=3*n.F.n8,l=3*n.F.n8,s&&(b="g1m_fftFinal"),d="g1m_fftJoin",g="g1m_fftMix","affine"==u?(p=2*n.F.n8,m="g1m_batchToAffine"):p=3*n.F.n8):"G2"==e?("affine"==o?(h=2*n.F.n8,c="g2m_batchToJacobian"):h=3*n.F.n8,l=3*n.F.n8,s&&(b="g2m_fftFinal"),d="g2m_fftJoin",g="g2m_fftMix","affine"==u?(p=2*n.F.n8,m="g2m_batchToAffine"):p=3*n.F.n8):"Fr"==e&&(h=n.n8,l=n.n8,p=n.n8,s&&(b="frm_fftFinal"),g="frm_fftMix",d="frm_fftJoin");let B=!1;Array.isArray(t)?(t=array2buffer(t,h),B=!0):t=t.slice(0,t.byteLength);let F=t.byteLength/h,L=utils_log2(F);if(1<<L!=F)throw Error("fft must be multiple of 2");if(L==r.s+1){let e;return(e=s?await _fftExtInv(t,o,u,a,f):await _fftExt(t,o,u,a,f),B)?buffer2array(e,p):e}s&&(y=r.inv(r.e(F))),buffReverseBits(t,h);let A=Math.min(16384,F),O=F/A;for(;O<i.concurrency&&A>=16;)O*=2,A/=2;let w=utils_log2(A),x=[];for(let e=0;e<O;e++){a&&a.debug(`${f}: fft ${L} mix start: ${e}/${O}`);let n=[];n.push({cmd:"ALLOC",var:0,len:l*A});let r=t.slice(A*e*h,A*(e+1)*h);n.push({cmd:"SET",var:0,buff:r}),c&&n.push({cmd:"CALL",fnName:c,params:[{var:0},{val:A},{var:0}]});for(let t=1;t<=w;t++)n.push({cmd:"CALL",fnName:g,params:[{var:0},{val:A},{val:t}]});w==L?(b&&(n.push({cmd:"ALLOCSET",var:1,buff:y}),n.push({cmd:"CALL",fnName:b,params:[{var:0},{val:A},{var:1}]})),m&&n.push({cmd:"CALL",fnName:m,params:[{var:0},{val:A},{var:0}]}),n.push({cmd:"GET",out:0,var:0,len:A*p})):n.push({cmd:"GET",out:0,var:0,len:l*A}),x.push(i.queueAction(n).then(t=>(a&&a.debug(`${f}: fft ${L} mix end: ${e}/${O}`),t)))}_=await Promise.all(x);for(let t=0;t<O;t++)_[t]=_[t][0];for(let t=w+1;t<=L;t++){a&&a.debug(`${f}: fft  ${L}  join: ${t}/${L}`);let e=1<<L-t,n=O/e,s=[];for(let o=0;o<e;o++)for(let u=0;u<n/2;u++){let h=r.exp(r.w[t],u*A),c=r.w[t],g=o*n+u,v=o*n+u+n/2,B=[];B.push({cmd:"ALLOCSET",var:0,buff:_[g]}),B.push({cmd:"ALLOCSET",var:1,buff:_[v]}),B.push({cmd:"ALLOCSET",var:2,buff:h}),B.push({cmd:"ALLOCSET",var:3,buff:c}),B.push({cmd:"CALL",fnName:d,params:[{var:0},{var:1},{val:A},{var:2},{var:3}]}),t==L?(b&&(B.push({cmd:"ALLOCSET",var:4,buff:y}),B.push({cmd:"CALL",fnName:b,params:[{var:0},{val:A},{var:4}]}),B.push({cmd:"CALL",fnName:b,params:[{var:1},{val:A},{var:4}]})),m&&(B.push({cmd:"CALL",fnName:m,params:[{var:0},{val:A},{var:0}]}),B.push({cmd:"CALL",fnName:m,params:[{var:1},{val:A},{var:1}]})),B.push({cmd:"GET",out:0,var:0,len:A*p}),B.push({cmd:"GET",out:1,var:1,len:A*p})):(B.push({cmd:"GET",out:0,var:0,len:A*l}),B.push({cmd:"GET",out:1,var:1,len:A*l})),s.push(i.queueAction(B).then(r=>(a&&a.debug(`${f}: fft ${L} join  ${t}/${L}  ${o+1}/${e} ${u}/${n/2}`),r)))}let o=await Promise.all(s);for(let t=0;t<e;t++)for(let e=0;e<n/2;e++){let r=t*n+e,i=t*n+e+n/2,s=o.shift();_[r]=s[0],_[i]=s[1]}}if(v=t instanceof BigBuffer?new BigBuffer(F*p):new Uint8Array(F*p),s){v.set(_[0].slice((A-1)*p));let t=p;for(let e=O-1;e>0;e--)v.set(_[e],t),t+=A*p,delete _[e];v.set(_[0].slice(0,(A-1)*p),t),delete _[0]}else for(let t=0;t<O;t++)v.set(_[t],A*p*t),delete _[t];return B?buffer2array(v,p):v}async function _fftExt(t,e,n,i,s){let o,u,a;o=t.slice(0,t.byteLength/2),u=t.slice(t.byteLength/2,t.byteLength);let f=[];[o,u]=await _fftJoinExt(o,u,"fftJoinExt",r.one,r.shift,e,"jacobian",i,s),f.push(_fft(o,!1,"jacobian",n,i,s)),f.push(_fft(u,!1,"jacobian",n,i,s));let h=await Promise.all(f);return(a=h[0].byteLength>268435456?new BigBuffer(2*h[0].byteLength):new Uint8Array(2*h[0].byteLength)).set(h[0]),a.set(h[1],h[0].byteLength),a}async function _fftExtInv(t,e,n,i,s){let o,u,a;o=t.slice(0,t.byteLength/2),u=t.slice(t.byteLength/2,t.byteLength);let f=[];f.push(_fft(o,!0,e,"jacobian",i,s)),f.push(_fft(u,!0,e,"jacobian",i,s)),[o,u]=await Promise.all(f);let h=await _fftJoinExt(o,u,"fftJoinExtInv",r.one,r.shiftInv,"jacobian",n,i,s);return(a=h[0].byteLength>268435456?new BigBuffer(2*h[0].byteLength):new Uint8Array(2*h[0].byteLength)).set(h[0]),a.set(h[1],h[0].byteLength),a}async function _fftJoinExt(t,s,o,u,a,f,h,l,p){let c,m,g,d,b,y,v,_;if("G1"==e)"affine"==f?(b=2*n.F.n8,m="g1m_batchToJacobian"):b=3*n.F.n8,y=3*n.F.n8,c="g1m_"+o,"affine"==h?(g="g1m_batchToAffine",d=2*n.F.n8):d=3*n.F.n8;else if("G2"==e)"affine"==f?(b=2*n.F.n8,m="g2m_batchToJacobian"):b=3*n.F.n8,c="g2m_"+o,y=3*n.F.n8,"affine"==h?(g="g2m_batchToAffine",d=2*n.F.n8):d=3*n.F.n8;else if("Fr"==e)b=r.n8,d=r.n8,y=r.n8,c="frm_"+o;else throw Error("Invalid group");if(t.byteLength!=s.byteLength)throw Error("Invalid buffer size");let B=Math.floor(t.byteLength/b);if(B!=1<<utils_log2(B))throw Error("Invalid number of points");let F=Math.floor(B/i.concurrency);F<16&&(F=16),F>65536&&(F=65536);let L=[];for(let e=0;e<B;e+=F){l&&l.debug(`${p}: fftJoinExt Start: ${e}/${B}`);let n=Math.min(B-e,F),o=r.mul(u,r.exp(a,e)),f=[],h=t.slice(e*b,(e+n)*b),v=s.slice(e*b,(e+n)*b);f.push({cmd:"ALLOC",var:0,len:y*n}),f.push({cmd:"SET",var:0,buff:h}),f.push({cmd:"ALLOC",var:1,len:y*n}),f.push({cmd:"SET",var:1,buff:v}),f.push({cmd:"ALLOCSET",var:2,buff:o}),f.push({cmd:"ALLOCSET",var:3,buff:a}),m&&(f.push({cmd:"CALL",fnName:m,params:[{var:0},{val:n},{var:0}]}),f.push({cmd:"CALL",fnName:m,params:[{var:1},{val:n},{var:1}]})),f.push({cmd:"CALL",fnName:c,params:[{var:0},{var:1},{val:n},{var:2},{var:3},{val:r.s}]}),g&&(f.push({cmd:"CALL",fnName:g,params:[{var:0},{val:n},{var:0}]}),f.push({cmd:"CALL",fnName:g,params:[{var:1},{val:n},{var:1}]})),f.push({cmd:"GET",out:0,var:0,len:n*d}),f.push({cmd:"GET",out:1,var:1,len:n*d}),L.push(i.queueAction(f).then(t=>(l&&l.debug(`${p}: fftJoinExt End: ${e}/${B}`),t)))}let A=await Promise.all(L);B*d>268435456?(v=new BigBuffer(B*d),_=new BigBuffer(B*d)):(v=new Uint8Array(B*d),_=new Uint8Array(B*d));let O=0;for(let t=0;t<A.length;t++)v.set(A[t][0],O),_.set(A[t][1],O),O+=A[t][0].byteLength;return[v,_]}n.fft=async function(t,e,n,r,i){return await _fft(t,!1,e,n,r,i)},n.ifft=async function(t,e,n,r,i){return await _fft(t,!0,e,n,r,i)},n.lagrangeEvaluations=async function(t,i,s,o,u){let a,f;if(i=i||"affine",s=s||"affine","G1"==e)a="affine"==i?2*n.F.n8:3*n.F.n8;else if("G2"==e)a="affine"==i?2*n.F.n8:3*n.F.n8;else if("Fr"==e)a=r.n8;else throw Error("Invalid group");let h=t.byteLength/a,l=utils_log2(h);if(2**l*a!=t.byteLength)throw o&&o.error("lagrangeEvaluations iinvalid input size"),Error("lagrangeEvaluations invalid Input size");if(l<=r.s)return await n.ifft(t,i,s,o,u);if(l>r.s+1)throw o&&o.error("lagrangeEvaluations input too big"),Error("lagrangeEvaluations input too big");let p=t.slice(0,t.byteLength/2),c=t.slice(t.byteLength/2,t.byteLength),m=r.exp(r.shift,h/2),g=r.inv(r.sub(r.one,m));[p,c]=await _fftJoinExt(p,c,"prepareLagrangeEvaluation",g,r.shiftInv,i,"jacobian",o,u+" prep");let d=[];return d.push(_fft(p,!0,"jacobian",s,o,u+" t0")),d.push(_fft(c,!0,"jacobian",s,o,u+" t1")),[p,c]=await Promise.all(d),(f=p.byteLength>268435456?new BigBuffer(2*p.byteLength):new Uint8Array(2*p.byteLength)).set(p),f.set(c,p.byteLength),f},n.fftMix=async function(t){let s,o,u;let a=3*n.F.n8;if("G1"==e)s="g1m_fftMix",o="g1m_fftJoin";else if("G2"==e)s="g2m_fftMix",o="g2m_fftJoin";else if("Fr"==e)s="frm_fftMix",o="frm_fftJoin";else throw Error("Invalid group");let f=Math.floor(t.byteLength/a),h=utils_log2(f),l=1<<utils_log2(i.concurrency);f<=2*l&&(l=1);let p=f/l,c=utils_log2(p),m=[];for(let e=0;e<l;e++){let n=[],r=t.slice(e*p*a,(e+1)*p*a);n.push({cmd:"ALLOCSET",var:0,buff:r});for(let t=1;t<=c;t++)n.push({cmd:"CALL",fnName:s,params:[{var:0},{val:p},{val:t}]});n.push({cmd:"GET",out:0,var:0,len:p*a}),m.push(i.queueAction(n))}let g=await Promise.all(m),d=[];for(let t=0;t<g.length;t++)d[t]=g[t][0];for(let t=c+1;t<=h;t++){let e=1<<h-t,n=l/e,s=[];for(let u=0;u<e;u++)for(let e=0;e<n/2;e++){let f=r.exp(r.w[t],e*p),h=r.w[t],l=u*n+e,c=u*n+e+n/2,m=[];m.push({cmd:"ALLOCSET",var:0,buff:d[l]}),m.push({cmd:"ALLOCSET",var:1,buff:d[c]}),m.push({cmd:"ALLOCSET",var:2,buff:f}),m.push({cmd:"ALLOCSET",var:3,buff:h}),m.push({cmd:"CALL",fnName:o,params:[{var:0},{var:1},{val:p},{var:2},{var:3}]}),m.push({cmd:"GET",out:0,var:0,len:p*a}),m.push({cmd:"GET",out:1,var:1,len:p*a}),s.push(i.queueAction(m))}let u=await Promise.all(s);for(let t=0;t<e;t++)for(let e=0;e<n/2;e++){let r=t*n+e,i=t*n+e+n/2,s=u.shift();d[r]=s[0],d[i]=s[1]}}u=t instanceof BigBuffer?new BigBuffer(f*a):new Uint8Array(f*a);let b=0;for(let t=0;t<l;t++)u.set(d[t],b),b+=d[t].byteLength;return u},n.fftJoin=async function(t,s,o,u){let a,f,h;let l=3*n.F.n8;if("G1"==e)a="g1m_fftJoin";else if("G2"==e)a="g2m_fftJoin";else if("Fr"==e)a="frm_fftJoin";else throw Error("Invalid group");if(t.byteLength!=s.byteLength)throw Error("Invalid buffer size");let p=Math.floor(t.byteLength/l);if(p!=1<<utils_log2(p))throw Error("Invalid number of points");let c=1<<utils_log2(i.concurrency);p<=2*c&&(c=1);let m=p/c,g=[];for(let e=0;e<c;e++){let n=[],f=r.mul(o,r.exp(u,e*m)),h=t.slice(e*m*l,(e+1)*m*l),p=s.slice(e*m*l,(e+1)*m*l);n.push({cmd:"ALLOCSET",var:0,buff:h}),n.push({cmd:"ALLOCSET",var:1,buff:p}),n.push({cmd:"ALLOCSET",var:2,buff:f}),n.push({cmd:"ALLOCSET",var:3,buff:u}),n.push({cmd:"CALL",fnName:a,params:[{var:0},{var:1},{val:m},{var:2},{var:3}]}),n.push({cmd:"GET",out:0,var:0,len:m*l}),n.push({cmd:"GET",out:1,var:1,len:m*l}),g.push(i.queueAction(n))}let d=await Promise.all(g);t instanceof BigBuffer?(f=new BigBuffer(p*l),h=new BigBuffer(p*l)):(f=new Uint8Array(p*l),h=new Uint8Array(p*l));let b=0;for(let t=0;t<d.length;t++)f.set(d[t][0],b),h.set(d[t][1],b),b+=d[t][0].byteLength;return[f,h]},n.fftFinal=async function(t,r){let s,o,u;let a=3*n.F.n8,f=2*n.F.n8;if("G1"==e)s="g1m_fftFinal",o="g1m_batchToAffine";else if("G2"==e)s="g2m_fftFinal",o="g2m_batchToAffine";else throw Error("Invalid group");let h=Math.floor(t.byteLength/a);if(h!=1<<utils_log2(h))throw Error("Invalid number of points");let l=Math.floor(h/i.concurrency),p=[];for(let e=0;e<i.concurrency;e++){let n;if(0==(n=e<i.concurrency-1?l:h-e*l))continue;let u=[],c=t.slice(e*l*a,(e*l+n)*a);u.push({cmd:"ALLOCSET",var:0,buff:c}),u.push({cmd:"ALLOCSET",var:1,buff:r}),u.push({cmd:"CALL",fnName:s,params:[{var:0},{val:n},{var:1}]}),u.push({cmd:"CALL",fnName:o,params:[{var:0},{val:n},{var:0}]}),u.push({cmd:"GET",out:0,var:0,len:n*f}),p.push(i.queueAction(u))}let c=await Promise.all(p);u=t instanceof BigBuffer?new BigBuffer(h*f):new Uint8Array(h*f);let m=0;for(let t=c.length-1;t>=0;t--)u.set(c[t][0],m),m+=c[t][0].byteLength;return u}}async function buildEngine(t){let e=await buildThreadManager(t.wasm,t.singleThread),n={};return n.q=o(t.wasm.q.toString()),n.r=o(t.wasm.r.toString()),n.name=t.name,n.tm=e,n.prePSize=t.wasm.prePSize,n.preQSize=t.wasm.preQSize,n.Fr=new WasmField1(e,"frm",t.n8r,t.r),n.F1=new WasmField1(e,"f1m",t.n8q,t.q),n.F2=new WasmField2(e,"f2m",n.F1),n.G1=new WasmCurve(e,"g1m",n.F1,t.wasm.pG1gen,t.wasm.pG1b,t.cofactorG1),n.G2=new WasmCurve(e,"g2m",n.F2,t.wasm.pG2gen,t.wasm.pG2b,t.cofactorG2),n.F6=new WasmField3(e,"f6m",n.F2),n.F12=new WasmField2(e,"ftm",n.F6),n.Gt=n.F12,buildBatchApplyKey(n,"G1"),buildBatchApplyKey(n,"G2"),buildBatchApplyKey(n,"Fr"),buildMultiexp(n,"G1"),buildMultiexp(n,"G2"),buildFFT(n,"G1"),buildFFT(n,"G2"),buildFFT(n,"Fr"),!function(t){let e=t.tm;t.pairing=function(n,r){e.startSyncOp();let i=e.allocBuff(t.G1.toJacobian(n)),s=e.allocBuff(t.G2.toJacobian(r)),o=e.alloc(t.Gt.n8);e.instance.exports[t.name+"_pairing"](i,s,o);let u=e.getBuff(o,t.Gt.n8);return e.endSyncOp(),u},t.pairingEq=async function(){let n,r;arguments.length%2==1?(n=arguments[arguments.length-1],r=(arguments.length-1)/2):(n=t.Gt.one,r=arguments.length/2);let i=[];for(let n=0;n<r;n++){let r=[],s=t.G1.toJacobian(arguments[2*n]);r.push({cmd:"ALLOCSET",var:0,buff:s}),r.push({cmd:"ALLOC",var:1,len:t.prePSize});let o=t.G2.toJacobian(arguments[2*n+1]);r.push({cmd:"ALLOCSET",var:2,buff:o}),r.push({cmd:"ALLOC",var:3,len:t.preQSize}),r.push({cmd:"ALLOC",var:4,len:t.Gt.n8}),r.push({cmd:"CALL",fnName:t.name+"_prepareG1",params:[{var:0},{var:1}]}),r.push({cmd:"CALL",fnName:t.name+"_prepareG2",params:[{var:2},{var:3}]}),r.push({cmd:"CALL",fnName:t.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),r.push({cmd:"GET",out:0,var:4,len:t.Gt.n8}),i.push(e.queueAction(r))}let s=await Promise.all(i);e.startSyncOp();let o=e.alloc(t.Gt.n8);e.instance.exports.ftm_one(o);for(let t=0;t<s.length;t++){let n=e.allocBuff(s[t][0]);e.instance.exports.ftm_mul(o,n,o)}e.instance.exports[t.name+"_finalExponentiation"](o,o);let u=e.allocBuff(n),a=!!e.instance.exports.ftm_eq(o,u);return e.endSyncOp(),a},t.prepareG1=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),n=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](e,n);let r=this.tm.getBuff(n,this.prePSize);return this.tm.endSyncOp(),r},t.prepareG2=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),n=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](e,n);let r=this.tm.getBuff(n,this.preQSize);return this.tm.endSyncOp(),r},t.millerLoop=function(t,e){this.tm.startSyncOp();let n=this.tm.allocBuff(t),r=this.tm.allocBuff(e),i=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](n,r,i);let s=this.tm.getBuff(i,this.Gt.n8);return this.tm.endSyncOp(),s},t.finalExponentiation=function(t){this.tm.startSyncOp();let e=this.tm.allocBuff(t),n=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](e,n);let r=this.tm.getBuff(n,this.Gt.n8);return this.tm.endSyncOp(),r}}(n),n.array2buffer=function(t,e){let n=new Uint8Array(e*t.length);for(let r=0;r<t.length;r++)n.set(t[r],r*e);return n},n.buffer2array=function(t,e){let n=t.byteLength/e,r=Array(n);for(let i=0;i<n;i++)r[i]=t.slice(i*e,i*e+e);return r},n}function utils_toNumber(t){return BigInt(t)}function u32(t){let e=[],n=utils_toNumber(t);return e.push(Number(255n&n)),e.push(Number(n>>8n&255n)),e.push(Number(n>>16n&255n)),e.push(Number(n>>24n&255n)),e}function string(t){let e=function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t);return[...varuint32(e.length),...e]}function varuint(t){let e=[],n=utils_toNumber(t);if(n<0n)throw Error("Number cannot be negative");for(;0n!==n;)e.push(Number(127n&n)),n>>=7n;0==e.length&&e.push(0);for(let t=0;t<e.length-1;t++)e[t]=128|e[t];return e}function varint(t){let e,n;let r=t<0n?t.toString(2).length-1:t.toString(2).length;t<0?(n=!0,e=(1n<<BigInt(r))+t):(n=!1,e=utils_toNumber(t));let i=7-r%7,s=(1n<<BigInt(i))-1n<<BigInt(r),o=varuint(e+s);return n||(o[o.length-1]=o[o.length-1]&((1<<7-i)-1|128)),o}function varint32(t){let e=utils_toNumber(t);if(e>4294967295n)throw Error("Number too big");if(e>2147483647n&&(e-=4294967296n),e<-2147483648n)throw Error("Number too small");return varint(e)}function varuint32(t){let e=utils_toNumber(t);if(e>4294967295n)throw Error("Number too big");return varuint(e)}function toHexString(t){return Array.from(t,function(t){return("0"+(255&t).toString(16)).slice(-2)}).join("")}let CodeBuilder=class CodeBuilder{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,e){let n=this.func.localIdxByName[t];if(void 0===n)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,33,...varuint32(n)]}teeLocal(t,e){let n=this.func.localIdxByName[t];if(void 0===n)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...e,34,...varuint32(n)]}getLocal(t){let e=this.func.localIdxByName[t];if(void 0===e)throw Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...varuint32(e)]}i64_load8_s(t,e,n){let r=e||0;return[...t,48,void 0===n?0:n,...varuint32(r)]}i64_load8_u(t,e,n){let r=e||0;return[...t,49,void 0===n?0:n,...varuint32(r)]}i64_load16_s(t,e,n){let r=e||0;return[...t,50,void 0===n?1:n,...varuint32(r)]}i64_load16_u(t,e,n){let r=e||0;return[...t,51,void 0===n?1:n,...varuint32(r)]}i64_load32_s(t,e,n){let r=e||0;return[...t,52,void 0===n?2:n,...varuint32(r)]}i64_load32_u(t,e,n){let r=e||0;return[...t,53,void 0===n?2:n,...varuint32(r)]}i64_load(t,e,n){let r=e||0;return[...t,41,void 0===n?3:n,...varuint32(r)]}i64_store(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=3,o=e):Array.isArray(n)?(i=e,s=3,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,55,s,...varuint32(i)]}i64_store32(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=2,o=e):Array.isArray(n)?(i=e,s=2,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,62,s,...varuint32(i)]}i64_store16(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=1,o=e):Array.isArray(n)?(i=e,s=1,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,61,s,...varuint32(i)]}i64_store8(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=0,o=e):Array.isArray(n)?(i=e,s=0,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,60,s,...varuint32(i)]}i32_load8_s(t,e,n){let r=e||0;return[...t,44,void 0===n?0:n,...varuint32(r)]}i32_load8_u(t,e,n){let r=e||0;return[...t,45,void 0===n?0:n,...varuint32(r)]}i32_load16_s(t,e,n){let r=e||0;return[...t,46,void 0===n?1:n,...varuint32(r)]}i32_load16_u(t,e,n){let r=e||0;return[...t,47,void 0===n?1:n,...varuint32(r)]}i32_load(t,e,n){let r=e||0;return[...t,40,void 0===n?2:n,...varuint32(r)]}i32_store(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=2,o=e):Array.isArray(n)?(i=e,s=2,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,54,s,...varuint32(i)]}i32_store16(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=1,o=e):Array.isArray(n)?(i=e,s=1,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,59,s,...varuint32(i)]}i32_store8(t,e,n,r){let i,s,o;return Array.isArray(e)?(i=0,s=0,o=e):Array.isArray(n)?(i=e,s=0,o=n):Array.isArray(r)&&(i=e,s=n,o=r),[...t,...o,58,s,...varuint32(i)]}call(t,...e){let n=this.module.functionIdxByName[t];if(void 0===n)throw Error(`Function not defined: Function: ${t}`);return[...[].concat(...e),16,...varuint32(n)]}call_indirect(t,...e){return[...[].concat(...e),...t,17,0,0]}if(t,e,n){return n?[...t,4,64,...e,5,...n,11]:[...t,4,64,...e,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...[...t]),11]}br_if(t,e){return[...e,13,...varuint32(t)]}br(t){return[12,...varuint32(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...function(t){let e=utils_toNumber(t);if(e>0xffffffffffffffffn)throw Error("Number too big");if(e>0x7fffffffffffffffn&&(e-=0x10000000000000000n),e<-0x8000000000000000n)throw Error("Number too small");return varint(e)}(t)]}i32_const(t){return[65,...varint32(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,e){return[...t,...e,81]}i64_ne(t,e){return[...t,...e,82]}i64_lt_s(t,e){return[...t,...e,83]}i64_lt_u(t,e){return[...t,...e,84]}i64_gt_s(t,e){return[...t,...e,85]}i64_gt_u(t,e){return[...t,...e,86]}i64_le_s(t,e){return[...t,...e,87]}i64_le_u(t,e){return[...t,...e,88]}i64_ge_s(t,e){return[...t,...e,89]}i64_ge_u(t,e){return[...t,...e,90]}i64_add(t,e){return[...t,...e,124]}i64_sub(t,e){return[...t,...e,125]}i64_mul(t,e){return[...t,...e,126]}i64_div_s(t,e){return[...t,...e,127]}i64_div_u(t,e){return[...t,...e,128]}i64_rem_s(t,e){return[...t,...e,129]}i64_rem_u(t,e){return[...t,...e,130]}i64_and(t,e){return[...t,...e,131]}i64_or(t,e){return[...t,...e,132]}i64_xor(t,e){return[...t,...e,133]}i64_shl(t,e){return[...t,...e,134]}i64_shr_s(t,e){return[...t,...e,135]}i64_shr_u(t,e){return[...t,...e,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,e){return[...t,...e,70]}i32_ne(t,e){return[...t,...e,71]}i32_lt_s(t,e){return[...t,...e,72]}i32_lt_u(t,e){return[...t,...e,73]}i32_gt_s(t,e){return[...t,...e,74]}i32_gt_u(t,e){return[...t,...e,75]}i32_le_s(t,e){return[...t,...e,76]}i32_le_u(t,e){return[...t,...e,77]}i32_ge_s(t,e){return[...t,...e,78]}i32_ge_u(t,e){return[...t,...e,79]}i32_add(t,e){return[...t,...e,106]}i32_sub(t,e){return[...t,...e,107]}i32_mul(t,e){return[...t,...e,108]}i32_div_s(t,e){return[...t,...e,109]}i32_div_u(t,e){return[...t,...e,110]}i32_rem_s(t,e){return[...t,...e,111]}i32_rem_u(t,e){return[...t,...e,112]}i32_and(t,e){return[...t,...e,113]}i32_or(t,e){return[...t,...e,114]}i32_xor(t,e){return[...t,...e,115]}i32_shl(t,e){return[...t,...e,116]}i32_shr_s(t,e){return[...t,...e,117]}i32_shr_u(t,e){return[...t,...e,118]}i32_rotl(t,e){return[...t,...e,119]}i32_rotr(t,e){return[...t,...e,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}};let _={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64};let FunctionBuilder=class FunctionBuilder{constructor(t,e,n,r,i){if("import"==n)this.fnType="import",this.moduleName=r,this.fieldName=i;else if("internal"==n)this.fnType="internal";else throw Error("Invalid function fnType: "+n);this.module=t,this.fnName=e,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,e){if(this.localIdxByName[t])throw Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let n=this.nextLocal++;this.localIdxByName[t]=n,this.params.push({type:e})}addLocal(t,e,n){if(this.localIdxByName[t])throw Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let r=this.nextLocal++;this.localIdxByName[t]=r,this.locals.push({type:e,length:n||1})}setReturnType(t){if(this.returnType)throw Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){let t=[...varuint32(this.params.length),...this.params.map(t=>_[t.type])],e=this.returnType?[1,_[this.returnType]]:[0];return[96,...t,...e]}getBody(){let t=this.locals.map(t=>[...varuint32(t.length),_[t.type]]),e=[...varuint32(this.locals.length),...[].concat(...t),...this.code,11];return[...varuint32(e.length),...e]}addCode(...t){this.code.push(...[].concat(...[...t]))}getCodeBuilder(){return new CodeBuilder(this)}};let modulebuilder_ModuleBuilder=class modulebuilder_ModuleBuilder{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...u32(1836278016),...u32(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(void 0!==this.functionIdxByName[t])throw Error(`Function already defined: ${t}`);let e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new FunctionBuilder(this,t,"internal")),this.nInternalFunctions++,this.functions[e]}addIimportFunction(t,e,n){if(void 0!==this.functionIdxByName[t])throw Error(`Function already defined: ${t}`);if(this.functions.length>0&&"internal"==this.functions[this.functions.length-1].type)throw Error(`Import functions must be declared before internal: ${t}`);let r=n||t,i=this.functions.length;return this.functionIdxByName[t]=i,this.functions.push(new FunctionBuilder(this,t,"import",e,r)),this.nImportFunctions++,this.functions[i]}setMemory(t,e,n){this.memory={pagesSize:t,moduleName:e||"env",fieldName:n||"memory"}}exportFunction(t,e){let n=e||t;if(void 0===this.functionIdxByName[t])throw Error(`Function not defined: ${t}`);let r=this.functionIdxByName[t];n!=t&&(this.functionIdxByName[n]=r),this.exports.push({exportName:n,idx:r})}addFunctionToTable(t){let e=this.functionIdxByName[t];this.functionsTable.push(e)}addData(t,e){this.datas.push({offset:t,bytes:e})}alloc(t,e){let n,r;(Array.isArray(t)||ArrayBuffer.isView(t))&&void 0===e?(n=t.length,r=t):(n=t,r=e),n=(n-1>>3)+1<<3;let i=this.free;return this.free+=n,r&&this.addData(i,r),i}allocString(t){let e=new globalThis.TextEncoder,n=e.encode(t);return this.alloc([...n,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let e=this.functions[this.functionsTable[0]].getSignature(),n="s_"+toHexString(e);t[n]=0,this.signatures.push(e)}for(let e=0;e<this.functions.length;e++){let n=this.functions[e].getSignature(),r="s_"+toHexString(n);void 0===t[r]&&(t[r]=this.signatures.length,this.signatures.push(n)),this.functions[e].signatureIdx=t[r]}}_buildSection(t,e){return[t,...varuint32(e.length),...e]}_buildType(){return this._buildSection(1,[...varuint32(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...string(this.memory.moduleName),...string(this.memory.fieldName),2,0,...varuint32(this.memory.pagesSize)]);for(let e=0;e<this.nImportFunctions;e++)t.push([...string(this.functions[e].moduleName),...string(this.functions[e].fieldName),0,...varuint32(this.functions[e].signatureIdx)]);return this._buildSection(2,varuint32(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(...varuint32(this.functions[e].signatureIdx));return this._buildSection(3,[...varuint32(t.length),...t])}_buildFunctionsTable(){return 0==this.functionsTable.length?[]:this._buildSection(4,[...varuint32(1),112,0,...varuint32(this.functionsTable.length)])}_buildElements(){if(0==this.functionsTable.length)return[];let t=[];for(let e=0;e<this.functionsTable.length;e++)t.push(...varuint32(this.functionsTable[e]));return this._buildSection(9,[...varuint32(1),...varuint32(0),65,...varint32(0),11,...varuint32(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let e=0;e<this.exports.length;e++)t.push([...string(this.exports[e].exportName),0,...varuint32(this.exports[e].idx)]);return this._buildSection(7,varuint32(t.length).concat(...t))}_buildCode(){let t=[];for(let e=this.nImportFunctions;e<this.nImportFunctions+this.nInternalFunctions;e++)t.push(this.functions[e].getBody());return this._buildSection(10,varuint32(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...u32(this.free)]);for(let e=0;e<this.datas.length;e++)t.push([0,65,...varint32(this.datas[e].offset),11,...varuint32(this.datas[e].bytes.length),...this.datas[e].bytes]);return this._buildSection(11,varuint32(t.length).concat(...t))}};async function bn128_buildBn128(t,e){let n=new modulebuilder_ModuleBuilder;n.setMemory(25),(0,c.buildBn128)(n),e&&e(n);let r={};if(r.code=n.build(),r.pq=n.modules.f1m.pq,r.pr=n.modules.frm.pq,r.pG1gen=n.modules.bn128.pG1gen,r.pG1zero=n.modules.bn128.pG1zero,r.pG1b=n.modules.bn128.pG1b,r.pG2gen=n.modules.bn128.pG2gen,r.pG2zero=n.modules.bn128.pG2zero,r.pG2b=n.modules.bn128.pG2b,r.pOneT=n.modules.bn128.pOneT,r.prePSize=n.modules.bn128.prePSize,r.preQSize=n.modules.bn128.preQSize,r.n8q=32,r.n8r=32,r.q=n.modules.bn128.q,r.r=n.modules.bn128.r,!t&&globalThis.curve_bn128)return globalThis.curve_bn128;let i={name:"bn128",wasm:r,q:o("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:o("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:o("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!t},s=await buildEngine(i);return s.terminate=async function(){i.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},t||(globalThis.curve_bn128=s),s}async function bls12381_buildBls12381(t,e){let n=new modulebuilder_ModuleBuilder;n.setMemory(25),(0,c.buildBls12381)(n),e&&e(n);let r={};if(r.code=n.build(),r.pq=n.modules.f1m.pq,r.pr=n.modules.frm.pq,r.pG1gen=n.modules.bls12381.pG1gen,r.pG1zero=n.modules.bls12381.pG1zero,r.pG1b=n.modules.bls12381.pG1b,r.pG2gen=n.modules.bls12381.pG2gen,r.pG2zero=n.modules.bls12381.pG2zero,r.pG2b=n.modules.bls12381.pG2b,r.pOneT=n.modules.bls12381.pOneT,r.prePSize=n.modules.bls12381.prePSize,r.preQSize=n.modules.bls12381.preQSize,r.n8q=48,r.n8r=32,r.q=n.modules.bls12381.q,r.r=n.modules.bls12381.r,!t&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let i={name:"bls12381",wasm:r,q:o("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:o("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:o("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:o("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!t},s=await buildEngine(i);return s.terminate=async function(){i.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},t||(globalThis.curve_bls12381=s),s}async function curves_getCurveFromName(t,e,n){let r;let i=t.toUpperCase().match(/[A-Za-z0-9]+/g).join("");if(["BN128","BN254","ALTBN128"].indexOf(i)>=0)r=await bn128_buildBn128(e,n);else if(["BLS12381"].indexOf(i)>=0)r=await bls12381_buildBls12381(e,n);else throw Error(`Curve not supported: ${t}`);return r}async function babyjub_buildBabyJub(){let t=await curves_getCurveFromName("bn128",!0);return new BabyJub(t.Fr)}n(21876).Buffer,globalThis.curve_bn128=null,globalThis.curve_bls12381=null,o("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),o("21888242871839275222246405745257275088548364400416034343698204186575808495617"),o("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),o("21888242871839275222246405745257275088696311157297823662689037894645226208583");let BabyJub=class BabyJub{constructor(t){this.F=t,this.p=r.fromString("21888242871839275222246405745257275088548364400416034343698204186575808495617"),this.pm1d2=r.div(r.sub(this.p,r.e(1)),r.e(2)),this.Generator=[t.e("995203441582195749578291179787384436505546430278305826713579947235728471134"),t.e("5472060717959818805561601436314318772137091100104008585924551046643952123905")],this.Base8=[t.e("5299619240641551281634865583518297030282874472190772894086521144482721001553"),t.e("16950150798460657717958625567821834550301663161624707787222815936182638968203")],this.order=r.fromString("21888242871839275222246405745257275088614511777268538073601725287587578984328"),this.subOrder=r.shiftRight(this.order,3),this.A=t.e("168700"),this.D=t.e("168696")}addPoint(t,e){let n=this.F,r=[],i=n.mul(t[0],e[1]),s=n.mul(t[1],e[0]),o=n.mul(n.sub(t[1],n.mul(this.A,t[0])),n.add(e[0],e[1])),u=n.mul(i,s),a=n.mul(this.D,u);return r[0]=n.div(n.add(i,s),n.add(n.one,a)),r[1]=n.div(n.add(o,n.sub(n.mul(this.A,i),s)),n.sub(n.one,a)),r}mulPointEscalar(t,e){let n=this.F,i=[n.e("0"),n.e("1")],s=e,o=t;for(;!r.isZero(s);)r.isOdd(s)&&(i=this.addPoint(i,o)),o=this.addPoint(o,o),s=r.shiftRight(s,1);return i}inSubgroup(t){let e=this.F;if(!this.inCurve(t))return!1;let n=this.mulPointEscalar(t,this.subOrder);return e.isZero(n[0])&&e.eq(n[1],e.one)}inCurve(t){let e=this.F,n=e.square(t[0]),r=e.square(t[1]);return!!e.eq(e.add(e.mul(this.A,n),r),e.add(e.one,e.mul(e.mul(n,r),this.D)))}packPoint(t){let e=this.F,n=new Uint8Array(32);e.toRprLE(n,0,t[1]);let i=e.toObject(t[0]);return r.gt(i,this.pm1d2)&&(n[31]=128|n[31]),n}unpackPoint(t){let e=this.F,n=!1,i=[,,];if(128&t[31]&&(n=!0,t[31]=127&t[31]),i[1]=e.fromRprLE(t,0),r.gt(e.toObject(i[1]),this.p))return null;let s=e.square(i[1]),o=e.div(e.sub(e.one,s),e.sub(this.A,e.mul(this.D,s))),u=e.exp(o,e.half);if(!e.eq(e.one,u))return null;let a=e.sqrt(o);return null==a?null:(n&&(a=e.neg(a)),i[0]=a,i)}};n(17462),n(97327),n(21876).Buffer,n(92525),n(21876).Buffer;var B=n(25290);let{unstringifyBigInts:F}=i,{C:L,M:A}=F(B.Z);n(27596)},41972:function(t,e,n){"use strict";n.d(e,{l:function(){return ContractFactory}});var r=n(2790),i=n(38640),s=n(455),o=n(5857),u=n(36024),a=n(57200);let ContractFactory=class ContractFactory{interface;bytecode;runner;constructor(t,e,n){let i=r.vU.from(t);e instanceof Uint8Array||("object"==typeof e&&(e=e.object),e.startsWith("0x")||(e="0x"+e)),e=(0,s.Dv)((0,s.Pw)(e)),(0,o.h)(this,{bytecode:e,interface:i,runner:n||null})}attach(t){return new a.VZ(t,this.interface,this.runner)}async getDeployTransaction(...t){let e={},n=this.interface.deploy;if(n.inputs.length+1===t.length&&(e=await (0,a.Jc)(t.pop())),n.inputs.length!==t.length)throw Error("incorrect number of arguments to constructor");let r=await (0,a.rq)(this.runner,n.inputs,t),i=(0,s.zo)([this.bytecode,this.interface.encodeDeploy(r)]);return Object.assign({},e,{data:i})}async deploy(...t){let e=await this.getDeployTransaction(...t);(0,u.hu)(this.runner&&"function"==typeof this.runner.sendTransaction,"factory runner does not support sending transactions","UNSUPPORTED_OPERATION",{operation:"sendTransaction"});let n=await this.runner.sendTransaction(e),r=(0,i.e)(n);return new a.VZ(r,this.interface,this.runner,n)}connect(t){return new ContractFactory(this.interface,this.bytecode,t)}static fromSolidity(t,e){(0,u.en)(null!=t,"bad compiler output","output",t),"string"==typeof t&&(t=JSON.parse(t));let n=t.abi,r="";return t.bytecode?r=t.bytecode:t.evm&&t.evm.bytecode&&(r=t.evm.bytecode),new this(n,r,e)}}}}]);