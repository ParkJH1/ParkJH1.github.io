(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[828],{21621:function(t,e,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/voter/[ZKPollContractAddress]",function(){return o(86217)}])},86217:function(t,e,o){"use strict";o.r(e);var n=o(85893),r=o(87357),a=o(69417),i=o(15861),l=o(51233),s=o(98456),c=o(92592),m=o(42474),f=o(11163),d=o(67294),u=o(21876).Buffer;let g=o(52325).tt;e.default=function(){let t=(0,f.useRouter)(),[e,o]=(0,d.useState)(""),[x,h]=(0,d.useState)(""),[y,S]=(0,d.useState)(!0);(0,d.useEffect)(()=>{t.isReady&&generateVoterCommitmentProofAndQRCode()},[t.isReady]);let generateVoterCommitmentProofAndQRCode=async()=>{S(!0);let e=t.query.ZKPollContractAddress;o(e);let n=localStorage.getItem("ZKPollVoter_zkPollData");if(null!==n){let t=JSON.parse(n);if(t.hasOwnProperty(e)){let o={proof:t[e].proof,publicSignals:t[e].publicSignals,cm:t[e].cm,contractAddress:t[e].contractAddress},n=await c.toDataURL(JSON.stringify(o));h(n)}else try{let o="0x"+u.from((0,m.randomBytes)(31)).toString("hex"),n="0x"+u.from((0,m.randomBytes)(31)).toString("hex"),{proof:r,publicSignals:a}=await g.fullProve({sk:o,r:n},"/wasm/VoterCommitment.wasm","/key/VoterCommitment_final.zkey"),i="0x"+BigInt(a[0]).toString(16),l={...t};l[e]={proof:r,publicSignals:a,sk:o,r:n,cm:i,contractAddress:e};let s=JSON.stringify(l);localStorage.setItem("ZKPollVoter_zkPollData",s);let f=await c.toDataURL(JSON.stringify(l[e]));h(f)}catch(t){console.log(t)}}else try{let t="0x"+u.from((0,m.randomBytes)(31)).toString("hex"),o="0x"+u.from((0,m.randomBytes)(31)).toString("hex"),{proof:n,publicSignals:r}=await g.fullProve({sk:t,r:o},"/wasm/VoterCommitment.wasm","/key/VoterCommitment_final.zkey"),a="0x"+BigInt(r[0]).toString(16),i={};i[e]={proof:n,publicSignals:r,sk:t,r:o,cm:a,contractAddress:e};let l=JSON.stringify(i);localStorage.setItem("ZKPollVoter_zkPollData",l);let s=await c.toDataURL(JSON.stringify(i[e]));h(s)}catch(t){console.log(t)}S(!1)};return(0,n.jsx)(n.Fragment,{children:y?(0,n.jsx)(r.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,n.jsx)(s.Z,{})}):(0,n.jsx)(r.Z,{sx:{display:"flex"},children:(0,n.jsxs)(r.Z,{component:"main",sx:{flexGrow:1,p:3},children:[(0,n.jsx)(i.Z,{align:"center",variant:"h3",gutterBottom:!0,children:"투표자 등록"}),(0,n.jsxs)(l.Z,{spacing:2,direction:"column",children:[(0,n.jsx)("img",{src:x}),(0,n.jsx)(i.Z,{variant:"h3",align:"center",children:"등록을 마쳤다면"}),(0,n.jsx)(a.Z,{fullWidth:!0,variant:"contained",onClick:()=>t.replace("/voter/".concat(e,"/vote")),children:"투표하기"})]})]})})})}},27790:function(){},95979:function(){},82825:function(){}},function(t){t.O(0,[714,792,808,240,417,237,94,10,958,592,774,888,179],function(){return t(t.s=21621)}),_N_E=t.O()}]);